<!DOCTYPE html> <html lang="ja"> <head> <meta charset="utf-8" /> <meta name="viewport" content="width=device-width,initial-scale=1" /> <title>YouTubeÈ¢®„Ç≥„É°„É≥„ÉàÊ¨ÑÔºàFirebaseÂØæÂøúÔºâ</title> <style> :root{ --bg:#ffffff; --card:#f9f9f9; --muted:#606060; --accent:#065fd4; --text:#111111; --accent-press:#054bb0; } *{box-sizing:border-box} body{ margin:0; font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", sans-serif; background:var(--bg); color:var(--text); padding:28px; } .comments-wrap{max-width:900px; margin:0 auto; display:grid; gap:16px;} .top-bar{display:flex; flex-wrap:wrap; gap:8px; justify-content:space-between; align-items:center;} .search-bar{flex:1; display:flex; gap:8px; align-items:center; padding:8px; border:1px solid #ccc; border-radius:8px; background:#fff;} .search-bar input{flex:1; border:none; outline:none; font-size:14px;} .sort-btn{background:#f1f1f1; border:1px solid #ccc; padding:8px 12px; border-radius:8px; cursor:pointer; font-size:14px; color:#333;} .sort-btn:hover{background:#e6e6e6;} .composer{background:var(--card); border:1px solid #ddd; padding:14px; border-radius:12px; display:flex; gap:12px; align-items:flex-start;} .avatar{width:44px; height:44px; border-radius:50%; background:linear-gradient(135deg,#5dd7ff,#7386ff);} .composer-main{flex:1} input#nickname{width:100%; margin-bottom:8px; padding:6px; border-radius:6px; border:1px solid #ccc; background:#fff; color:var(--text);} textarea#newComment{width:100%; min-height:72px; resize:vertical; border-radius:8px; padding:10px; font-size:14px; border:1px solid #ccc; background:#fff; color:var(--text); outline:none;} .composer-row{display:flex; justify-content:space-between; align-items:center; gap:12px; margin-top:8px;} .btn{background:var(--accent); color:#fff; border:none; padding:8px 12px; border-radius:8px; cursor:pointer; font-weight:600;} .btn:active{background:var(--accent-press)} .btn.ghost{background:#f1f1f1; color:var(--muted); border:1px solid #ddd} .counter{color:var(--muted); font-size:13px} .list{display:flex; flex-direction:column; gap:12px;} .comment-card{display:flex; gap:12px; padding:12px; border-radius:10px; background:var(--card); border:1px solid #ddd;} .comment-body{flex:1} .meta{display:flex; gap:8px; align-items:center; flex-wrap:wrap} .name{font-weight:700; font-size:14px} .time{color:var(--muted); font-size:13px} .text{margin-top:8px; font-size:15px; line-height:1.5; color:var(--text)} mark{background:yellow; padding:0 2px; border-radius:2px;} </style> </head> <body> <div class="comments-wrap" id="commentsWrap"> <h2 style="margin:0 0 4px 0">„Ç≥„É°„É≥„Éà</h2> <div class="top-bar"> <div class="search-bar"><input type="text" id="searchInput" placeholder="„Ç≥„É°„É≥„Éà„ÇíÊ§úÁ¥¢..." /></div> <button id="sortBtn" class="sort-btn">üîΩ Êñ∞„Åó„ÅÑÈ†Ü</button> </div> <div class="composer"> <div class="avatar"></div> <div class="composer-main"> <input id="nickname" type="text" placeholder="„Éã„ÉÉ„ÇØ„Éç„Éº„É†" maxlength="20" /> <textarea id="newComment" maxlength="1000" placeholder="„Ç≥„É°„É≥„Éà„ÇíÂÖ•Âäõ..."></textarea> <div class="composer-row"> <div class="counter" id="composerCounter">0 / 1000</div> <div style="display:flex; gap:8px"> <button class="btn ghost" id="clearBtn">„ÇØ„É™„Ç¢</button> <button class="btn" id="postBtn">ÊäïÁ®ø</button> </div> </div> </div> </div> <div class="list" id="commentList"></div> </div> <script type="module"> // === Firebase„ÅÆÂ∞éÂÖ• === import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js"; import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js"; const firebaseConfig = { apiKey: "AIzaSyBn_w4fPZlFXqfiwYzJzUKuW10LdJyV-AA", authDomain: "comments-1910e.firebaseapp.com", databaseURL: "https://comments-1910e-default-rtdb.firebaseio.com", projectId: "comments-1910e", storageBucket: "comments-1910e.firebasestorage.app", messagingSenderId: "126460518015", appId: "1:126460518015:web:0595fd3bd496224c8c294a", measurementId: "G-SXTPFYM6V5" }; const app = initializeApp(firebaseConfig); const db = getDatabase(app); const commentsRef = ref(db, "comments"); // === Êó¢Â≠ò„Ç≥„Éº„Éâ === function timeStampLocale(d){ const now = new Date(); const diff = Math.floor((now - d) / 1000); if(diff < 60) return diff + "ÁßíÂâç"; if(diff < 3600) return Math.floor(diff/60) + "ÂàÜÂâç"; if(diff < 86400) return Math.floor(diff/3600) + "ÊôÇÈñìÂâç"; return d.toLocaleString('ja-JP'); } function createAvatarGradient(seed){ const colors = [ "linear-gradient(135deg,#5dd7ff,#7386ff)", "linear-gradient(135deg,#ffb86b,#ff7aa2)", "linear-gradient(135deg,#a5ffb6,#6be7ff)", "linear-gradient(135deg,#c59bff,#7ed6a3)", ]; return colors[Math.abs(seed) % colors.length]; } const newComment = document.getElementById('newComment'); const nicknameInput = document.getElementById('nickname'); const composerCounter = document.getElementById('composerCounter'); const clearBtn = document.getElementById('clearBtn'); const postBtn = document.getElementById('postBtn'); const commentList = document.getElementById('commentList'); const searchInput = document.getElementById('searchInput'); const sortBtn = document.getElementById('sortBtn'); let allComments = []; let sortOrder = "newest"; newComment.addEventListener('input', ()=> { composerCounter.textContent = newComment.value.length + " / " + newComment.maxLength; }); clearBtn.addEventListener('click', ()=>{ newComment.value = ""; newComment.dispatchEvent(new Event('input')); }); postBtn.addEventListener('click', ()=> { const text = newComment.value.trim(); const nick = nicknameInput.value.trim() || "ÂåøÂêç"; if(!text){ alert('„Ç≥„É°„É≥„Éà„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ'); return; } const comment = { author: nick, text, time: new Date().toISOString() }; push(commentsRef, comment); // Firebase„Å´‰øùÂ≠ò newComment.value = ""; newComment.dispatchEvent(new Event('input')); }); sortBtn.addEventListener('click', ()=> { sortOrder = (sortOrder === "newest") ? "oldest" : "newest"; sortBtn.textContent = sortOrder === "newest" ? "üîΩ Êñ∞„Åó„ÅÑÈ†Ü" : "üîº Âè§„ÅÑÈ†Ü"; renderComments(); }); searchInput.addEventListener('input', ()=>{ renderComments(); }); // === Firebase„Åã„Çâ„Ç≥„É°„É≥„Éà„ÇíÂèñÂæó === onValue(commentsRef, (snapshot)=> { const data = snapshot.val() || {}; allComments = Object.values(data); renderComments(); }); // === „É¨„É≥„ÉÄ„É™„É≥„Ç∞ === function renderComments(){ commentList.innerHTML = ""; const keyword = searchInput.value.trim(); let list = [...allComments]; list.sort((a,b)=>{ return sortOrder === "newest" ? new Date(b.time) - new Date(a.time) : new Date(a.time) - new Date(b.time); }); list.forEach(c => { if(matchesKeyword(c, keyword)){ appendComment(c, keyword); } }); } function matchesKeyword(comment, keyword){ if(!keyword) return true; return ( comment.author.toLowerCase().includes(keyword.toLowerCase()) || comment.text.toLowerCase().includes(keyword.toLowerCase()) ); } function appendComment(commentObj, keyword=""){ const li = document.createElement('div'); li.className = 'comment-card'; const avatar = document.createElement('div'); avatar.className = 'avatar'; avatar.style.background = createAvatarGradient(commentObj.author.length); const body = document.createElement('div'); body.className = 'comment-body'; body.innerHTML = ` <div class="meta"> <div class="name">${highlight(commentObj.author, keyword)}</div> <div class="time">${timeStampLocale(new Date(commentObj.time))}</div> </div> <div class="text">${highlight(commentObj.text, keyword).replace(/\n/g,'<br>')}</div> `; li.appendChild(avatar); li.appendChild(body); commentList.appendChild(li); } function highlight(text, keyword){ if(!keyword) return escapeHtml(text); const regex = new RegExp(`(${keyword.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi"); return escapeHtml(text).replace(regex, "<mark>$1</mark>"); } function escapeHtml(str){ return String(str).replace(/[&<>"']/g, (m)=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); } </script> </body> </html>